<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:Nalu.Maui.Sample.PageModels"
             xmlns:nalu="https://nalu-development.github.com/nalu/layouts"
             x:Class="Nalu.Maui.Sample.Pages.ExpanderPage"
             x:DataType="pageModels:ExpanderPageModel"
             Title="Expander VirtualScroll">
    <ContentPage.Content>
        <Grid Background="LightBlue">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" 
                  ColumnDefinitions="*,*"
                  Padding="16,8"
                  ColumnSpacing="8"
                  BackgroundColor="#E0E0E0">
                <Button Grid.Column="0"
                        Text="Add Item"
                        Command="{Binding AddItemCommand}" />
                <Button Grid.Column="1"
                        Text="Remove Item"
                        Command="{Binding RemoveItemCommand}" />
            </Grid>

            <nalu:VirtualScroll Grid.Row="1"
                                x:Name="VirtualScroll"
                                Adapter="{Binding Items}"
                                FadingEdgeLength="32"
                                Background="LightBlue">
                <nalu:VirtualScroll.HeaderTemplate>
                    <DataTemplate x:DataType="pageModels:ExpanderPageModel">
                        <VerticalStackLayout Padding="16">
                            <Image Source="banner.png"
                                   HeightRequest="100"
                                   Aspect="AspectFit"
                                   Margin="0,8,0,16" />
                        
                            <Label Text="{Binding Message}"
                                   FontSize="24"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center" />
                            
                            <Label Text="Tap items to expand/collapse them. Use buttons to add/remove items."
                                   FontSize="14"
                                   TextColor="Gray"
                                   HorizontalOptions="Center"
                                   Margin="0,8,0,0" />
                        </VerticalStackLayout>
                    </DataTemplate>
                </nalu:VirtualScroll.HeaderTemplate>

                <nalu:VirtualScroll.FooterTemplate>
                    <DataTemplate x:DataType="pageModels:ExpanderPageModel">
                        <VerticalStackLayout Padding="16,24" Background="LightBlue">
                            <Label Text="{Binding InstanceCount, StringFormat='Page Instance: {0}'}"
                                   HorizontalOptions="Center"
                                   TextColor="Gray" />
                            <Label Text="End of expandable list"
                                   HorizontalOptions="Center"
                                   FontSize="12"
                                   TextColor="DarkGray" />
                        </VerticalStackLayout>
                    </DataTemplate>
                </nalu:VirtualScroll.FooterTemplate>

                <nalu:VirtualScroll.ItemTemplate>
                    <DataTemplate x:DataType="pageModels:ExpanderItem">
                        <nalu:ViewBox Padding="16,8">
                            <Border StrokeShape="RoundRectangle 12"
                                    BackgroundColor="Coral">
                                <VerticalStackLayout>
                                    <nalu:ExpanderViewBox CollapsedHeight="80"
                                                          IsExpanded="{Binding IsExpanded}">
                                        <VerticalStackLayout Padding="16,8">
                                            <Label Text="{Binding Name}" 
                                                   FontSize="Large"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding Description}"
                                                   FontSize="14"
                                                   TextColor="DarkSlateGray"/>
                                        </VerticalStackLayout>
                                    </nalu:ExpanderViewBox>
                                    <Button Text="Toggle"
                                            BackgroundColor="Coral"
                                            TextColor="Black"
                                            Command="{Binding ToggleCommand}"/>
                                </VerticalStackLayout>
                            </Border>
                        </nalu:ViewBox>
                    </DataTemplate>
                </nalu:VirtualScroll.ItemTemplate>
            </nalu:VirtualScroll>
        </Grid>
    </ContentPage.Content>
</ContentPage>

